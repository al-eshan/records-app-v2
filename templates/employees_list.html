{% extends "base.html" %}
{% block content %}

<div class="container" style="max-width: 1200px;">
  <div class="card shadow-sm">
    <div class="card-body p-4">

      <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
        <div>
          <h4 class="mb-1">الموظفين</h4>
          <div class="text-muted">إدارة بيانات الموظفين والتنبيهات</div>
        </div>

        <a href="/employees/new" class="btn btn-success">
          ➕ إضافة موظف
        </a>
      </div>

      <div class="table-wrap">
        <div class="table-responsive">
          <table class="table table-hover align-middle text-center mb-0">
            <thead class="table-dark">
              <tr>
                <th>الاسم عربي</th>
                <th>الاسم إنجليزي</th>

                {# اختياري: لو تبغاهم في القائمة #}
                <th class="d-none d-md-table-cell">الجنسية</th>
                <th class="d-none d-md-table-cell">الجوال</th>

                <th>انتهاء الجواز</th>
                <th>انتهاء الإقامة</th>
                <th>انتهاء التأمين</th>
                <th style="width: 220px;">إجراءات</th>
              </tr>
            </thead>

            <tbody>
              {% if rows|length == 0 %}
                <tr>
                  <td colspan="8" class="text-muted py-4">لا يوجد موظفين</td>
                </tr>
              {% endif %}

              {% for r in rows %}
              <tr>
                <td class="fw-semibold">{{ r.name_ar }}</td>
                <td>{{ r.name_en or "-" }}</td>

                {# اختياري: يظهرون في الديسكتوب فقط عشان الجوال ما يزحم #}
                <td class="d-none d-md-table-cell">{{ r.nationality or "-" }}</td>
                <td class="d-none d-md-table-cell">{{ r.mobile or "-" }}</td>

                <td class="{{ status_color(r.passport_expiry) }}">
                  {{ r.passport_expiry or "-" }}
                </td>
                <td class="{{ status_color(r.iqama_expiry) }}">
                  {{ r.iqama_expiry or "-" }}
                </td>
                <td class="{{ status_color(r.insurance_expiry) }}">
                  {{ r.insurance_expiry or "-" }}
                </td>

                <td>
                  <div class="d-flex flex-wrap gap-2 justify-content-center">
                    <a href="/employees/{{ r.id }}" class="btn btn-sm btn-info">تفاصيل</a>
                    <a href="/employees/{{ r.id }}/edit" class="btn btn-sm btn-warning">تعديل</a>

                    <form method="post"
                          action="/employees/{{ r.id }}/delete"
                          class="m-0"
                          onsubmit="return confirm('حذف الموظف؟');">
                      <button class="btn btn-sm btn-danger">حذف</button>
                    </form>
                  </div>

                  {# سطر إضافي للجوال فقط يعرض الجنسية/الجوال بدون زحمة #}
                  <div class="d-md-none small text-muted mt-2 text-start">
                    <div>الجنسية: {{ r.nationality or "-" }}</div>
                    <div>الجوال: {{ r.mobile or "-" }}</div>
                  </div>
                </td>
              </tr>
              {% endfor %}
            </tbody>

          </table>
        </div>
      </div>

    </div>
  </div>
</div>

{% endblock %}
